@{
    ViewData["Title"] = "Thanh toan";
    Layout = "~/Views/Shared/_CartCheckoutLayout.cshtml";
}

@using EcommerceWebsite.Models.Checkout
@model CheckoutViewModel

<!-- Breadcrumb Section Begin -->
<section class="breadcrumb-section set-bg" data-setbg="../ContentOgani/img/breadcrumb.jpg">
    <div class="container">
        <div class="row">
            <div class="col-lg-12 text-center">
                <div class="breadcrumb__text">
                    <h2>Checkout</h2>
                    <div class="breadcrumb__option">
                        <a href="./index.html">Home</a>
                        <span>Checkout</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Breadcrumb Section End -->
<!-- Checkout Section Begin -->
<!-- Checkout Section Begin -->
<section class="checkout spad">
    <div class="container">
        <div class="checkout__form">
            <h4>Billing Details</h4>

            @using (Html.BeginForm("Checkout", "Checkout", FormMethod.Post))
            {
                @Html.AntiForgeryToken()
                <div class="row">
                    <div class="col-lg-5 col-md-6">
                        <div class="checkout__input">
                            @{
                                string userId = Context.Session.GetString("UserName");
                                string name = null;

                                if (!string.IsNullOrEmpty(userId))
                                {
                                    // Assuming you have a DbContext named QlbanVaLiContext
                                    using (var context = new QlbanVaLiContext())
                                    {
                                        // Fetch the user from the database based on the MaKhachHang
                                        name = context.TKhachHangs
                                        .Where(x => x.MaKhachHang == userId)
                                        .Select(x => x.TenKhachHang)
                                        .FirstOrDefault();
                                    }
                                }
                            }
                            <label asp-for="Name" class="control-label"></label>
                            <input asp-for="Name" class="form-control" value="@name" disabled></input>

                        </div>
                        <div class="checkout__input">

                            @Html.LabelFor(model => model.Address)
                            @Html.TextBoxFor(model => model.Address, new { @class = "form-control" })

                        </div>
                        <div class="checkout__input">
                            @Html.LabelFor(model => model.District)
                            @Html.TextBoxFor(model => model.District, new { @class = "form-control" })
                        </div>
                        <div class="checkout__input">
                            @Html.LabelFor(model => model.Province)
                            @Html.TextBoxFor(model => model.Province, new { @class = "form-control" })
                        </div>
                        <div class="checkout__input">
                            @{

                                string phone = null;

                                if (!string.IsNullOrEmpty(userId))
                                {
                                    // Assuming you have a DbContext named QlbanVaLiContext
                                    using (var context = new QlbanVaLiContext())
                                    {
                                        // Fetch the user from the database based on the MaKhachHang
                                        phone = context.TKhachHangs
                                        .Where(x => x.MaKhachHang == userId)
                                        .Select(x => x.SoDienThoai)
                                        .FirstOrDefault();
                                    }
                                }
                            }
                            <label asp-for="Phone" class="control-label"></label>
                            <input asp-for="Phone" class="form-control" value="@phone" disabled></input>
                        </div>
                    </div>
                    <div class="col-lg-7 col-md-3">
@*                         @await Component.InvokeAsync("OrderArea")
 *@
                        <button type="submit" class="site-btn">PLACE ORDER</button>
                    </div>
                </div>
            }
        </div>
    </div>
</section>
<!-- Checkout Section End -->